<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="da" style="font-size: 100%">
<head>
    <title>fcoo.dk - leaflet-bootstrap - Demo</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta http-equiv='x-dns-prefetch-control' content='on'>

    <meta name='copyright' content='FCOO'>
    <meta name='owner' content='FCOO'>

    <link  href="bower_components.css" rel="stylesheet">
    <link  href="../src/leaflet-bootstrap.css" rel="stylesheet">
    <link  href="css/all.css" rel="stylesheet">
    <style>
        html, body, #map {
            padding: 0; margin: 0; width:100%; height:100%;
        }
    </style>

</head>

<body>
    <div id="map" style="cursor: pointer; _width: 800px; _height: 600px"></div>
    <script src="bower_components.js"></script>
    <script src="../src/1_leaflet-bootstrap.js"></script>
    <script src="../src/2_leaflet-bootstrap-control.js"></script>
    <script src="../src/3_leaflet-bootstrap-control-button.js"></script>
    <script src="../src/4_leaflet-bootstrap-control-modal.js"></script>
    <script src="../src/5_leaflet-bootstrap-control-scale.js"></script>
    <script src="../src/6_leaflet-bootstrap-contextmenu.js"></script>
    <script src="../src/7_leaflet-bootstrap-control-position.js"></script>
    <script src="../src/8_leaflet-bootstrap-control-zoom.js"></script>
    <script src="../src/leaflet-bootstrap-popup.js"></script>
    <script src="../src/leaflet-bootstrap-tooltip.js"></script>


    <script>

    window.bsIsTouch = false;
    window.bsIsTouch = (window.location.search =='?touch');

    i18next.init();
    i18next.changeLanguage('da');

    latLngFormat.setFormat(window.latLngFormat.LATLNGFORMAT_UTM);
    //latLngFormat.setFormat(window.latLngFormat.LATLNGFORMAT_MGRS);
    //latLngFormat.setFormat(window.latLngFormat.LATLNGFORMAT_NAC);


    //latLngFormat.setFormat(window.latLngFormat.LATLNGFORMAT_DMSS);
    //latLngFormat.setFormat(window.latLngFormat.LATLNGFORMAT_DMM);
    //latLngFormat.setFormat(window.latLngFormat.LATLNGFORMAT_DD);

//    window.setTimeout(function(){ latLngFormat.setFormat(window.latLngFormat.LATLNGFORMAT_DD) }, 5000 );
//    window.setTimeout(function(){ latLngFormat.setFormat(window.latLngFormat.LATLNGFORMAT_NAC) }, 10000 );


    function setLatLngFormat(){
        if (latLngFormat.options.formatId == latLngFormat.LATLNGFORMAT_LAST)
            latLngFormat.setFormat(latLngFormat.LATLNGFORMAT_FIRST);
        else
            latLngFormat.setFormat(latLngFormat.options.formatId + 1);

        window.notyInfo('Auto changed to format id = '+ latLngFormat.options.formatId, { layout: 'center', timeout: 1500 } );
    }


    var map = L.map('map', {
        zoomControl: true,
        bsZoomControl: true,
        bsPositionControl: true,
        bsPositionOptions: {
            isExtended        : true,
            showCursorPosition: false,
            selectFormat: setLatLngFormat
        },
        zoomSnap: .25,
        worldCopyJump: true,
    }).setView([56.2, 11.5], 6);


    L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 18,
        attribution: '&copy; <a href="http://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors</a>'
    }).addTo(map);

    L.marker([54,12], {draggable: true}).addTo(map).bindTooltip({icon:'fa-home', text:'Godt'}, {delay:2000});

    /**********************************************
    Add contextmenu to the map
    **********************************************/
    var first = null;
//    map.setContextmenuHeader({icon:'fa-home', text:'MAP header'});
    map.setContextmenuHeader('MAP');

    map.addContextmenuItems([
        {icon:'fa-home', text:{da:'Map#1'}, onClick: function(latlng){ console.log('MAP 1',this, latlng); } },
        {icon:'fa-map',  text:'Map#2 (dont close)',      onClick: function(latlng){ console.log('MAP 2',this, latlng); }, closeOnClick: false }
    ]);

    map.on('click', function( e ){
        var marker =
            (!first ? L.bsMarkerCircle : L.marker)( e.latlng, {
                draggable: true,
                colorName: 'red',
                shadow: false
            })
                .on('click', function(){ this.remove(); })
            .bindPopup({
                header: 'Overskrift',
                content: 'Davslkjsssldkfjslkdjlaksjdflkasjdflaksjdflkasjdf',
                fixable: true,
                width: 200,
            })
            .addTo(map);
        marker.addContextmenuItems([
            {icon:'fa-home', text:{da:first?'Blue#1':'RED#1'}, onClick: function(latlng){ console.log('Marker 1',this, latlng); }, closeOnClick: false },
            {icon:'fa-map',  text:{da:first?'Blue#22':'RED#2'}, onClick: function(latlng){ console.log('Marker 2',this, latlng); } },
        ]);
        if (first)
            marker.setContextmenuOptions({width:800});
        marker.setContextmenuHeader(first ? {text:'Blue markers'} : {text:{da:'RED Markers'}});
        marker.setContextmenuParent(first);
        if (first)
            marker.excludeMapContextmenu();

        first = first || marker;
    });

    L.polygon([[
        [58.99,14.05],
        [58.98,3.22],
        [55.94,3.58],
        [55.94,14.03],
        [58.99,14.05]
    ]], {color:'red'})
        .addTo(map)
        .addContextmenuItems([
            {icon:'fa-home', text:{da:'RED Poly 1'}, onClick: function(latlng){ console.log('RED Poly 1',this, latlng); }},
            {icon:'fa-map',  text:'RED Poly 2', onClick: function(latlng){ console.log('RED Poly 2',this, latlng); }},
        ]);

    L.polygon([[
        [57.99,14.05],
        [57.98,13.22],
        [56.94,13.58],
        [56.94,15.03],
        [57.99,15.05]
    ]], {color:'green'})
        .addTo(map)
        .addContextmenuItems([
            {icon:'fa-home', text:{da:'GREEN Poly 1'}, onClick: function(latlng){ console.log('GREEN Poly 1',this, latlng); }},
            {icon:'fa-map',  text:'GREEN Poly 2', onClick: function(latlng){ console.log('GREEN Poly 2',this, latlng); }},
        ]);



    var bGroup = L.control.bsButtonGroup({
            list: [
                {icon:'fa-home'},
                {icon:'fa-plus'},
                {icon:'fa-minus'},
                {icon:'fa-map'}
            ]
        });
        map.addControl(bGroup);


    //************************
    map.addControl(
        L.control.bsScale({
            position: 'bottomleft', isExtended: true,
        })

    );


    map.addControl(
        L.control.bsScale({
            position: 'topleft', mode:'metric', isExtended: false, maxUnitsWidthPercent: 30, maxUnitsWidth: 1200,
        })
    );

    map.addControl(
        L.control.bsScale({
            position: 'bottomleft', mode:'nautical', isExtended: false, maxUnitsWidthPercent: 60, maxUnitsWidth: 1200,
        })
    );
//*/

//*
    //************************
    var buttonBox = L.control.bsButtonBox({
        position: 'bottomright',
        icon: 'icon-leaflet-position-marker',
        square: true,

        content: {
            _noVerticalPadding: true,
            noHorizontalPadding: true,
            _noHeader: true,
            header: {
                text: 'The long header'
            },
            content: [
                {type:'button', semiTransparent: true, text:'Davs', small: true},
                {type:'button', text:'Davs2', small: true}
            ],
            width: 'auto',
            clickable: false,
            footer: { text: {da: 'Klik på signaturfork. for info', en:'Click on legend for info' }}


        }
    });

    map.addControl(buttonBox);
    //************************
    var selectItems3 = [
            {id: 'item1', text:{da:'Emne#1', en: 'Item#1'} },
            {id: 'item2', text:{da:'Emne#2', en: 'Item#2'} },
            {id: 'item3', text:{da:'Emne#3', en: 'Item#3'} },
            {id: 'item4', text:{da:'Emne#4', en: 'Item#4'} },
            {id: 'item5', text:{da:'Emne#5', en: 'Item#5'} },
            {id: 'item6', text:{da:'Emne#6', en: 'Item#6'} },
            {id: 'item7', text:{da:'Emne#7', en: 'Item#7'} },
            {id: 'item8', text:{da:'Emne#8', en: 'Item#8'} },
        ];


    //************************
    var modalControl = L.control.bsModal({
            flex: true,
            header: 'Header max h = 111/222',

            width: 222,
            maxHeight: 111,
            content: 'w=222, dette er en test<br>Linie2<br>Linie3<br>Linie4<br>Linie5',

            isExtended: true,
            extended: {
                width: 555,
                maxHeight: 222,
                scroll: true,
                content: {
                    type: 'tabs',
                    hideNotSelectedText: true,
                    list: [
                        {
                            icon: 'fa-home',  text:{da:'Hjem', en:'Home'},
                            content: {
                                type: 'select', _selectedId: 'formSelect4', placeholder:"Placeholder", label:'Label',
                                items:[
                                    {id:'formSelect1', icon:'fa-home', text: 'Davs'},
                                    {id:'formSelect2', text:'Item 2'},
                                    {id:'formSelect3', text:'Item 3 SKIDE GODT'},
                                    {id:'formSelect4', text:'Item 4'},
                                    {id:'formSelect5', text:'Item 5'}
                                ]
                            }
                        },

                        {
                            icon: 'fa-map',  text:{da:'Kort', en:'Map'},
                            _content: 'FIRST Sint sit mollit irure quis est nostrud cillum consequat Lorem esse do quis dolor esse fugiat sunt do. Eu ex commodo veniam Lorem aliquip laborum occaecat qui Lorem esse mollit dolore anim cupidatat. Deserunt officia id Lorem nostrud aute id commodo elit eiusmod enim irure amet eiusmod qui reprehenderit nostrud tempor. Fugiat ipsum excepteur in aliqua non et quis aliquip ad irure in labore cillum elit enim. Consequat aliquip incididunt ipsum et minim laborum laborum laborum et cillum labore. Deserunt adipisicing cillum id nulla minim nostrud labore eiusmod et amet. Laboris consequat consequat commodo non ut non aliquip reprehenderit nulla anim occaecat. Sunt sit ullamco reprehenderit irure ea ullamco Lorem aute nostrud magna.',
                            content: {
                                type:'slider', label:'Label (NIELS)',
                                _handle: 'round',
                                _showFromTo: false,
                                grid: true, resizeable: true,
                                min:0, max:100, majorTicksOffset:0, _step:5, stepOffset:0, postfix:' km/t', _onChanging: function( obj ){ console.log( obj.value ); }
                            }
                        },
                        {
                            icon: 'fa-globe',
                            title:{da:'Tidszone', en:'Time zone'},
                            content: {
                                type: 'tabs',
                                small: true,
                                list: [
                                    {icon: 'fa-home',  text:{da:'Hjem', en:'Home'}, scroll: true, content: 'FIRST  Sint sit mollit irure quis est nostrud cillum consequat Lorem esse do quis dolor esse fugiat sunt do. Eu ex commodo veniam Lorem aliquip laborum occaecat qui Lorem esse mollit dolore anim cupidatat. Deserunt officia id Lorem nostrud aute id commodo elit eiusmod enim irure amet eiusmod qui reprehenderit nostrud tempor.'},
                                    {icon: 'fa-globe', title:{da:'Tidszone', en:'Time zone'},content: 'SECOND', scroll: true},
                                    {icon: 'fa-calendar',title:{da:'Dato og tid', en:'Date and time'},selected: true,content: '3.'}
                                ],
                            },
                            footer: [{text: {da:'Format', en:'Format'}}, {text: {da:'Formatet', en:'The format'}, link:function(){ console.log('Skide godt')} }]
                        },
                        {
                            icon: 'fa-calendar',
                            title:{da:'Dato og tid2', en:'Date and time'},
                            selected: true,
                            content: {
                                type: 'selectlist',
                                selectedId: 'item2',
                                items     : [
                                    {id: 'item1', text:{da:'Emne#1', en: 'Item#1'} },
                                    {id: 'item2', text:{da:'Emne#2', en: 'Item#2'} },
                                    {id: 'item3', text:{da:'Emne#3', en: 'Item#3'} },
                                    {id: 'item4', text:{da:'Emne#4', en: 'Item#4'} },
                                    {id: 'item5', text:{da:'Emne#5', en: 'Item#5'} },
                                    {id: 'item6', text:{da:'Emne#6', en: 'Item#6'} },
                                    {id: 'item7', text:{da:'Emne#7', en: 'Item#7'} },
                                    {id: 'item8', text:{da:'Emne#8', en: 'Item#8'} },
                                ],
                                _onChange  : function(id, selected, $buttonGroup){console.log('bsSelectbox2', id, selected)},
                            }
                        }
                    ],
                },
            }, //end of extended

            buttons: [
                {icon:'fa-map', text:'Kort', onClick: function(){ console.log('Klik på kort'); } }
            ],

            show: true

        });

//HER        map.addControl( modalControl );

    //************************************************************
    var formControl = L.control.bsModalForm({
            id: 'formId',
            _show: true,
            header: 'Davs',
            buttons: [
                {text:'Reset', onClick: function(){ testModalForm.setValue('formId1', -1);}      },
                {text:'Set=2', onClick: function(){ testModalForm.setValue('formId1', 'formSelect1');} }
            ],
            onSubmit: function( data ){ console.log( 'SUBMIT=', data ); myData = data; },
            onCancel: function( data ){ console.log( 'CANCEL=', data ); myData = data; },
            width: 321,
            content: {
                type: 'accordion',
                list: [
                    {
                        icon: 'fa-globe',
                        title:{da:'En test', en:'A test'},
                        content: [
                {
                    id: 'mySlider', type:'slider', label:'Label (NIELS)',
                    _handle: 'round',
                    _showFromTo: false,
                    grid: true,
                    min:0, max:100, majorTicksOffset:0, _step:5, stepOffset:0, postfix:' km/t', _onChanging: function( obj ){ console.log( obj.value ); }
                },

                {
                    id:'mySelection', type:'checkbox', text: 'Vælg mig'
                },
                {
                    id:'formId2', validators: 'notEmpty _MYvalidatorName', type:'input',placeholder:'Placeholder (INPUT)', label: 'Label (NIELS)', after : {type:'button', text:{da:'kr.', en:'£'}}, before: {type:'button', icon:'fa-calculator'}
                },
                {
                    id:'formId1', type: 'select', validators: 'notEmpty', _selectedId: 'formSelect4', placeholder:"Placeholder", label:'Label',
                    items:[
                        {id:'formSelect1', icon:'fa-home', text: 'Davs'},
                        {id:'formSelect2', text:'Item 2'},
                        {id:'formSelect3', text:'Item 3 SKIDE GODT'},
                        {id:'formSelect4', text:'Item 4'},
                        {id:'formSelect5', text:'Item 5'}
                    ],
                    showWhen: {'mySelection': false }
                 },
                {
                    id:'formId2-1', type: 'select', _selectedId: 'formSelect4', placeholder:"Placeholder", label:'Label',
                    items:[
                        {id:'formSelect1', icon:'fa-home', text: 'Davs'},
                        {id:'formSelect2', text:'Item 2'},
                        {id:'formSelect3', text:'Item 3 SKIDE GODT'},
                        {id:'formSelect4', text:'Item 4'},
                        {id:'formSelect5', text:'Item 5'}
                    ]
                },
                {
                    id:'formId3', type:'input',placeholder:'Placeholder (INPUT)', label: 'Label (NIELS)', after : {type:'button', text:{da:'kr.', en:'£'}}, before: {type:'button', icon:'fa-calculator'}
                },
                {
                    id:'formId4', type:'input',placeholder:'Placeholder (INPUT)', label: 'Label (NIELS)', after : {type:'button', text:{da:'kr.', en:'£'}}, before: {type:'button', icon:'fa-calculator'}
                },
            ]
            },
            {
                icon: 'fa-globe',
                title:{da:'En anden test', en:'Another test'},
            }
            ]}
    });

    map.addControl( formControl );
    var myData = { mySlider: 33 };
    map.addControl( L.control.bsButton({
        icon:'fa-edit',
        onClick: function(){
            formControl.bsModalForm.edit( myData );
        }
    }) );


    //************************************************************
    map.addControl( L.control.bsButton({
        icon:['fa-edit', 'fa-home'],
    }) );


    //************************************************************
    function showPopup( mouseEvent ){
        var longContent = function(){
                var content = '';
                lines = 15;
                for (var i=0; i<lines; i++ ){
                    content += 'line '+i+'<br>';
                }
                return $('<div>' + content + 'This is a random<br>number '+Math.floor(Math.random()*1000000) +'</div>');
            }(),
            shortContent = 'shortContent: Det er bare mig';

        var popup = L.popup().setContent({
            scroll      : true,
            fixable     : true,
            header      : {text:'setContent: This is a very long header and it should be to long'},
            closeButton : true,
            buttons     : [{
               icon:'fas fa-map-marker-alt',
                text:'Marker',
                //closeOnClick: true,
                //onClick: function(){addMarker(mouseEvent.latlng);}
            }],

            //verticalButtons : true,
            width: 234,
            minimized: {
                width  : 130,
                content: 'MINI',
                className: 'text-center',
                clickable: true,
                _noVerticalPadding  : true,
                _noHorizontalPadding: true,
                showHeaderOnClick: true,
                _transparent: true
            },

            content: shortContent,
            clickable: true,

            _isMinimized: true,
            extended: {
                width  : 345,
                content: longContent,
                scroll : true
            },
        });


        var marker = L.marker(mouseEvent.latlng).addTo(map);
        marker.bindPopup(popup).openPopup();

    };
//*/
    </script>
</body>
</html>
